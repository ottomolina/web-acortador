import{a as T,b as E,c as F,d as P,e as z,f as D}from"./chunk-E4BG3XCW.js";import{a as R,b as j}from"./chunk-WXE6GEYV.js";import"./chunk-F4QVPDHD.js";import{a as U}from"./chunk-PBFH472O.js";import"./chunk-QCNTN3VJ.js";import"./chunk-44UDCAZB.js";import{$a as l,Fa as S,Gb as d,Hb as m,Ka as h,Sb as L,Za as o,_a as a,ab as f,cc as I,fc as A,gb as y,ib as v,oc as B,pc as M,sb as s,ub as c,wa as b,wb as _,xa as r,xb as C,yb as w,za as p}from"./chunk-4MXV6QT5.js";var x=class{static testUrl(t){try{if(!this.isValidPattern(t))throw new Error("Invalid url!");return new URL(t),""}catch{throw new Error("Invalid url!")}}static isValidPattern(t){return new RegExp("^(http(s*)?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}};function N(i,t){if(i&1&&(a(0,"div",11),s(1),l()),i&2){let e=v();r(),c(" ",e.error," ")}}function O(i,t){if(i&1&&(a(0,"div",12)(1,"div",13),s(2),l()()),i&2){let e=v();r(2),c(" ",e.error," ")}}function V(i,t){i&1&&(a(0,"div",14),s(1),d(2,"translate"),l()),i&2&&(r(),c(" ",m(2,1,"form-link.success-result")," "))}function W(i,t){if(i&1&&(a(0,"div",15)(1,"p",16)(2,"span"),s(3),d(4,"translate"),l(),a(5,"a",17),s(6),l()(),f(7,"app-button-copy",18),l()),i&2){let e=v();r(3),c("",m(4,4,"form-link.text-result"),":\xA0"),r(2),o("href",e.app.getUrlShort(e.shortLink.urlShorten),b),r(),c(" ",e.app.getUrlShort(e.shortLink.urlShorten)," "),r(),o("textToCopy",e.app.getUrlShort(e.shortLink.urlShorten))}}var g=class i{constructor(t,e,n,k,u){this.app=t;this.translate=e;this.linkService=n;this.cdRef=k;this.counterService=u}txtUrl="";error="";showSuccessAlert=!1;shortLink;disabledBtnAction=!1;async clickAdd(){if(!this.verifyUrl())return;this.disabledBtnAction=!0;let t={urlOriginal:this.txtUrl,urlShorten:this.generateString(),state:!0,date:this.app.getDate()};try{let e=await this.linkService.add(t);await this.counterService.createCounter(e.id),this.showSuccessAlert=!0,this.shortLink=t,this.txtUrl="",this.disabledBtnAction=!1,this.cdRef.detectChanges(),setTimeout(()=>{this.showSuccessAlert=!1,this.cdRef.detectChanges()},2500)}catch(e){this.disabledBtnAction=!1,console.error("error",e),this.app.toast.error(this.translate.instant("form-link.error.add-link"))}}verifyUrl(){if(this.error="",!this.txtUrl.trim())return this.error=this.translate.instant("form-link.error.txt-url-blank"),!1;try{x.testUrl(this.txtUrl)}catch{return this.error=this.translate.instant("form-link.error.txt-url-invalid"),!1}return!0}characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";generateString(t=8){let e="";for(let n=0;n<t;n++)e+=this.characters.charAt(Math.floor(Math.random()*this.characters.length));return e}static \u0275fac=function(e){return new(e||i)(p(U),p(B),p(R),p(L),p(j))};static \u0275cmp=S({type:i,selectors:[["app-form-link"]],decls:17,vars:16,consts:[[1,"container","py-2"],[3,"title","search"],[1,"row","px-2","px-md-0"],[1,"col","d-flex","flex-md-row","flex-column","gap-3"],["type","text","id","txtLink","aria-describedby","errorBlock",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["id","errorBlock","class","form-text d-flex d-md-none",4,"ngIf"],["type","button",1,"btn","btn-primary",2,"height","fit-content",3,"click","disabled"],["class","row px-2 px-md-0 d-none d-md-flex",4,"ngIf"],[1,"row","mx-2","mx-md-0"],["class","alert alert-success","role","alert",4,"ngIf"],["class","col d-flex flex-md-row flex-column gap-3 col-result py-4",4,"ngIf"],["id","errorBlock",1,"form-text","d-flex","d-md-none"],[1,"row","px-2","px-md-0","d-none","d-md-flex"],["id","errorBlock",1,"form-text"],["role","alert",1,"alert","alert-success"],[1,"col","d-flex","flex-md-row","flex-column","gap-3","col-result","py-4"],[1,"d-flex","flex-grow-1"],["target","_blank",1,"fw-bold",3,"href"],[3,"textToCopy"]],template:function(e,n){e&1&&(a(0,"div",0),f(1,"app-tabbar",1),d(2,"translate"),f(3,"br"),a(4,"div",2)(5,"div",3)(6,"input",4),d(7,"translate"),w("ngModelChange",function(u){return C(n.txtUrl,u)||(n.txtUrl=u),u}),l(),h(8,N,2,1,"div",5),a(9,"button",6),y("click",function(){return n.clickAdd()}),s(10),d(11,"translate"),l()()(),h(12,O,3,1,"div",7),f(13,"br"),a(14,"div",8),h(15,V,3,3,"div",9)(16,W,8,6,"div",10),l()()),e&2&&(r(),o("title",m(2,10,"form-link.title"))("search",!1),r(5),_("ngModel",n.txtUrl),o("placeholder",m(7,12,"form-link.placeholder-link")),r(2),o("ngIf",n.error),r(),o("disabled",n.disabledBtnAction),r(),c(" ",m(11,14,"form-link.button-action")," "),r(2),o("ngIf",n.error),r(3),o("ngIf",n.showSuccessAlert),r(),o("ngIf",n.shortLink))},dependencies:[A,I,D,F,P,z,T,E,M],styles:[".col-result[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #94c4fc;background:#e0ecfc}a[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{color:#404daa}.form-text[_ngcontent-%COMP%]{color:red}"]})};export{g as default};
